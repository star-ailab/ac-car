import gym
from gym.envs.registration import register

# get samples for environment
from gymmalware.gym_malware.envs.utils import interface, pefeatures
sha256 = interface.get_available_sha256()
# create a holdout set
from sklearn.model_selection import train_test_split
import numpy as np
np.random.seed(123)
sha256_train, sha256_holdout = train_test_split(sha256, test_size=50) #mine: original 300
sha256_train = sha256 ## Train set contains all REMEMBER to change this later

MAXTURNS = 5

exists_already=[]
for env in gym.envs.registry.env_specs:
    if 'malware' in env:
        print("Remove {} from registry".format(env))
        exists_already.append(env)

for e in exists_already:
    del gym.envs.registry.env_specs[e]

register(
    id='malware-v0',
    entry_point='gymmalware.gym_malware.envs:MalwareEnv',
    kwargs={'random_sample': True, 'maxturns': MAXTURNS, 'sha256list': sha256_train}
)

register(
    id='malware-test-v0',
    entry_point='gymmalware.gym_malware.envs:MalwareEnv',
    kwargs={'random_sample': False, 'maxturns': MAXTURNS, 'sha256list': sha256_holdout}
)

register(
    id='malware-score-v0',
    entry_point='gymmalware.gym_malware.envs:MalwareScoreEnv',
    kwargs={'random_sample': True, 'maxturns': MAXTURNS, 'sha256list': sha256_train}
)

register(
    id='malware-score-test-v0',
    entry_point='gymmalware.gym_malware.envs:MalwareScoreEnv',
    kwargs={'random_sample': False, 'maxturns': MAXTURNS, 'sha256list': sha256_holdout}
)

